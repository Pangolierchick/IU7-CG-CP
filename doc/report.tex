\documentclass[a4paper,14pt, unknownkeysallowed]{extreport} 
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[russian]{babel}
%\usepackage[14pt]{extsizes}
\usepackage{multirow}
\usepackage{listings}
\usepackage{graphicx}
\graphicspath{ {./img/} }
\usepackage{amsmath,amsfonts,amssymb,amsthm,mathtools} 
\usepackage{titlesec}
\usepackage{geometry}
\usepackage{caption}
\usepackage[hidelinks]{hyperref}
\usepackage{amsmath}

\frenchspacing
\usepackage{indentfirst} % Красная строка

\usepackage{setspace}
\onehalfspacing % Полуторный интервал

\lstset{ %
basicstyle=\small\sffamily, % размер и начертание шрифта для подсветки кода
numbers=left,               % где поставить нумерацию строк (слева\справа)
numberstyle=\tiny,           % размер шрифта для номеров строк
stepnumber=1,                   % размер шага между двумя номерами строк
numbersep=5pt,                % как далеко отстоят номера строк от подсвечиваемого кода
showspaces=false,            % показывать или нет пробелы специальными отступами
showstringspaces=false,      % показывать или нет пробелы в строках
showtabs=false,             % показывать или нет табуляцию в строках
frame=single,              % рисовать рамку вокруг кода
tabsize=2,                 % размер табуляции по умолчанию равен 2 пробелам
captionpos=t,              % позиция заголовка вверху [t] или внизу [b] 
breaklines=true,           % автоматически переносить строки (да\нет)
breakatwhitespace=false, % переносить строки только если есть пробел
escapeinside={\#*}{*)}   % если нужно добавить комментарии в коде
}

\geometry{pdftex, left = 3cm, right = 10mm, top = 2cm, bottom = 2cm}

% Для измененных титулов глав:
\usepackage{titlesec, blindtext, color} % подключаем нужные пакеты
\definecolor{gray75}{gray}{0.75} % определяем цвет
\newcommand{\hsp}{\hspace{20pt}} % длина линии в 20pt

% caption for tables at top
\usepackage{float}
\floatstyle{plaintop}
\restylefloat{table}

\titleformat{\chapter}[hang]{\Huge\bfseries}{\thechapter\hsp\textcolor{gray75}{|}\hsp}{0pt}{\Huge\bfseries}


\begin{document}
    \thispagestyle{empty}
    \textbf{Индивидуальное задание:}
    \newline
    Разработать программу для применения цветового фильтра на изображение для упрощения различения цветов для людей, страдающих дальтонизмом.

    \pagebreak
    \tableofcontents

    \chapter*{Введение}
    \addcontentsline{toc}{chapter}{Введение}

    Дальтонизм, цветовая слепота, — наследственная, реже приобретённая, особенность зрения человека и приматов, выражающаяся в сниженной способности или полной неспособности видеть или различать все или некоторые цвета.

    Дальтонизм неизлечимая болезнь, но сегодняшние технологии могут помочь людям, страдающим этой болезнью, видеть изображение и различать цвета.

    Дальтонизмом страдают примерно 1 из 12 мужчин и 1 из 200 женщин. Большинство людей с дальтонизмом имеют нормальное зрение, но не различают какие-то конкретные цвета. Очень редки случаи полной цветовой слепоты.

    У человека в центральной части сетчатки расположены светочувствительные рецепторы — нервные клетки, которые называются колбочками. Каждый из трёх видов колбочек имеет свой тип светочувствительного пигмента, характеризующийся определённым спектром поглощения. Первый тип пигмента, условно называемый «красным», имеет максимум чувствительности к спектру с максимумом 560 нм; другой, «зелёный» — с максимумом 530 нм; третий, «синий» — с максимумом 430 нм.

    Виды дальтонизма:

    \begin{itemize}
        \item Монохромия ~--~ полная цветовая слепота.
        \item Дихроматия ~--~ способность распознавать только два цвета.
        \begin{itemize}
            \item Протанопия ~--~ отсутствие пигмента, ответственного за красный цвет.
            \item Дейтеранопия ~--~ отсутствие пигмента, ответственного за зеленый цвет.
            \item Тританопия ~--~ отсутствие пигмента, ответственного за синий цвет.
        \end{itemize}
    \end{itemize}

    Цель работы ~--~ реализовать программное обеспечение для изменения цветовой палитры изображения на дисплее с учетом конкретного вида дальтонизма в реальном времени.

    Чтобы достигнуть поставленной цели, требуется решить следующие задачи:

    \begin{itemize}
        \item Проанализировать существующие виды дальтонизма;
        \item Проанализировать существующие алгоритмы преобразования цветов;
        \item Проанализировать существующие цветовые модели, чтобы выбрать подходящие для решения задачи;
        \item Спроектировать и реализовать алгоритм изменения цветов изображения с учетом заболевания пользователя;
        \item Проанализировать существующие симуляторы дальтонизма;
        \item Сравнить результат с учетом симуляции существующих видов дальтонизма;
    \end{itemize}

    Исходя из приведенных выше фактов, стоит \textit{задача} разработать такую программу, которая будет в реальном времени изменять цвета так, чтобы человек страдающий конкретным видом дальтонизма смог различать цвета на дисплее своего персонального компьютера.

    \pagebreak

    \chapter{Аналитическая часть}
    В данном разделе описаны цветовые модели, пригодные для решения задачи, виды дальтонизма, выбор цветовой модели, анализ существующих решений и возможных решений.

    \section{Формализация задачи}
    
    Изображение на дисплее состоит из пикселей. Пиксели состоят из субпикселей: красного, зеленого, синего. 
    
    Пиксель ~--~ это наименьший логический элемент двумерного цифрового изображения в растровой графике, или физический элемент матрицы дисплеев, формирующих изображение.

    Для преобразования цветов на дисплее используются средства операционной системы, таких как: Windows, Mac OS, Linux, Android, IOS.
    
    При работе с цветами в операционных системах используется цветовая модель RGB, RGBA. Однако, для решения поставленной проблемы будут использоваться и другие модели. Общее решение задачи можно представить в виде формулы \ref{math:base_formula}

    \begin{equation}
        CM_{\text{converted}} = F(CM_{\text{initial}}),
    \end{equation}
    \label{math:base_formula}

    \noindent
    где F - функция преобразования цветовой модели, $CM_{\text{converted}}$ и $CM_{\text{initial}}$ - начальная и преобразованная цветовые модели соответственно.

    \section{Дальтонизм}
    Дальтонизм, цветовая слепота, — наследственная, реже приобретённая, особенность зрения человека и приматов, выражающаяся в сниженной способности или полной неспособности видеть или различать все или некоторые цвета.
    
    \subsection{Виды дальтонизма}
    \begin{enumerate}
        \item Монохроматия ~---~ полная цветовая слепота
        \item Дихроматия
        \begin{itemize}
            \item Протанопия ~---~ Отсутствие L типа колбочек (Невозможность видеть красный цвет)
            \item Дейтеранопия ~---~ Отсутствие M типа колбочек (Невозможность видеть зеленый цвет)
            \item Тританопия ~---~ Отсутствие S типа колбочек (Невозможность видеть синий цвет)
        \end{itemize}
        \item Аномальная трихроматия
        \begin{itemize}
            \item Протаномалия ~---~ Проблемы с L типом колбочек (ухудшение видимости красного цвета)
            \item Дейтераномалия ~---~ Проблемы с M типом колбочек (ухудшение видимости зеленого цвета)
            \item Тританомалия ~---~ Проблемы с S типом колбочек (ухудшение видимости синего цвета)
        \end{itemize}
    \end{enumerate}

    \section{Алгоритмы преобразования цветов}
    В данном разделе представлены алгоритмы преобразования цветов для коррекции конкретных типов дальтонизма.

    \subsection{Коррекция цвета для дихроматии}

    Существует множество исследований, направленных на коррекцию цвета для дихроматии. Эти алгоритмы различаются по типам дихроматии. 
    Алгоритмы для коррекции цвета изображения будут представлены далее. 
    
    Для коррекции цвета используются следующие алгоритмы:

    \begin{enumerate}
        \item The LMS Daltonization алгоритм.
        \item Алгоритм улучшения контрастности цвета.
        \item LAB корректировка цвета.
        \item Цветовой сдвиг (Color shifting)
        \item CBFS алгоритм
    \end{enumerate}

    К. Эрдоган и Н. Ильмаз предложили метод сдвига цвета в цветовой модели HSV \footnote{HSV (или HSB) - цветовая модель, в которой координатами цвета являются: тон, насыщенность, значение цвета (яркость).}. Главная идея состоит в том, чтобы сдвинуть насыщенность цвета (Hue) для всего спектра на конкретное значение $v \in [0.1, 0.9]$.

    CBFS алгоритм ~---~ алгоритм, с помощью которого проводится коррекция цвета в зависимости от 6 параметров, введенных пользователем. Алгоритм рассчитан на людей с красным и зеленым типом цветовой слепоты. Алгоритм основан на преобразовании цвета из цветовой модели RGB в HSL \footnote{Данные цветовые модели (RGB, HSL) будут рассмотрены далее.}.

    C. L. Lai разработал портативную систему для людей с плохим зрением или дальтонизмом. 
    Его система имеет три этапа обработки:
    \begin{enumerate}
        \item Составление модели видимости.
        \item Компенсация восприятия.
        \item Распознавание шаблонов.
    \end{enumerate}

    Замеченные выше алгоритмы могут быть использованы для всех типов дихроматии. Следовательно, алгоритмы, описанные в данной работе будут реализованы для конкретных типов цветовой слепоты, но это не исключает их использования для других типов дальтонизма.

    \subsection{Алгоритмы корректировки цвета для дихроматии}

    В таблице \ref{tab:colorblind_algos} представлены алгоритмы корректировки цвета для различных типов дихроматии.

    \begin{table}[h]
        \centering
        \begin{tabular}{|l|l|}
        \hline
        Тип           & Алгоритм                                 \\ \hline
        Протанопия    & LMS Daltonization \& CBFS                \\ \hline
        Дейтеранопия  & LMS Daltonization \& LAB корректировка   \\ \hline
        Тританопия    & LMS Daltonization \& Цветовой сдвиг      \\ \hline
        \end{tabular}
        \caption{Алгоритмы корректировки цвета}
        \label{tab:colorblind_algos}
    \end{table}

    \subsection{LMS Daltonization алгоритм}

    Данный алгоритм один из самых известных алгоритмов для корректировки цвета для людей с цветовой слепотой.
    Главная идея заключается в том, чтобы использовать информацию, потерянную в ходе симуляции цветовой слепоты и использовать цветовое пространство LMS, чтобы компенсировать отсутствующие цвета в каждой группе (типе) колбочек: длинные (L), средние (M) и короткие (S).


    LMS Daltonization состоит из следующих шагов:
    \begin{enumerate}
        \item Преобразование цветовой модели из RGB в LMS
        \begin{equation}
            \begin{pmatrix}
                L \\
                M \\
                S \\
            \end{pmatrix} = 
            \begin{pmatrix}
                17.8824 & 43.5161 & 4.11935 \\
                3.45565 & 27.1554 & 3.86714 \\
                0.0299566 & 0.184309 & 1.46709 \\
            \end{pmatrix} \cdot
            \begin{pmatrix}
                R \\
                G \\
                B \\
            \end{pmatrix}
        \end{equation}

        \item Симуляция цветовой слепоты, используя формулы: \ref{eq:color_blind_sim_prot} для Протанопии, \ref{eq:color_blind_sim_deut} для Дейтеранопии и \ref{eq:color_blind_sim_trit} для Тританопии:
        \begin{itemize}
            \item \begin{equation}
                \label{eq:color_blind_sim_prot}
                \begin{pmatrix}
                    L_P \\
                    M_P \\
                    S_P \\
                \end{pmatrix} = 
                \begin{pmatrix}
                    0 & 2.02344 & -2.52581 \\
                    0 & 1 & 0 \\
                    0 & 0 & 1 \\
                \end{pmatrix} \cdot
                \begin{pmatrix}
                    L\\
                    M \\
                    S \\
                \end{pmatrix}
            \end{equation}
            
           
            \item
             \begin{equation} 
                \label{eq:color_blind_sim_deut}
                \begin{pmatrix}
                    L_D \\
                    M_D \\
                    S_D \\
                \end{pmatrix} = 
                \begin{pmatrix}
                    1 & 0 & 0 \\
                    0.49421 & 0 & 1.24827 \\
                    0 & 0 & 1 \\
                \end{pmatrix} \cdot
                \begin{pmatrix}
                    L\\
                    M \\
                    S \\
                \end{pmatrix}
            \end{equation}

            \item
             \begin{equation}
                \label{eq:color_blind_sim_trit}
                \begin{pmatrix}
                    L_T \\
                    M_T \\
                    S_T \\
                \end{pmatrix} = 
                \begin{pmatrix}
                    1 & 0 & 0 \\
                    0 & 1 & 0 \\
                    -0.395913 & 0.801109 & 0 \\
                \end{pmatrix} \cdot
                \begin{pmatrix}
                    L\\
                    M \\
                    S \\
                \end{pmatrix}
            \end{equation}
        \end{itemize}

        \item Конвертация $L_i M_i S_i$ обратно в $R_i G_i B_i$, используя формулу \ref{eq:lms_2_rgb}, $i = \{P, D, T\}$
        \begin{equation}
            \label{eq:lms_2_rgb}
            \begin{pmatrix}
                R_i \\
                G_i \\
                B_i \\
            \end{pmatrix} = 
            \begin{pmatrix}
                0.0809444479 & -0.130504409 & 0.116721066 \\
                0.113614708 & -0.0102485335 & 0.0540193266 \\
                -0.000365296938 & -0.00412161469 & 0.693511405 \\
            \end{pmatrix} \cdot
            \begin{pmatrix}
                L_i\\
                M_i \\
                S_i \\
            \end{pmatrix}
        \end{equation}

        \item Найти разность между исходным изображением и преобразованным.
        $D_{R(i)} = R - R_i$, \\
        $D_{G(i)} = G - G_i$, \\
        $D_{B(i)} = B - B_i$

        \item Сдвинуть цвета в сторону видимого спектра с помощью умножения на матрицу ошибок: \ref{eq:color_blind_err_prot} для Протанопии, \ref{eq:color_blind_err_deut} для Дейтеранопии и \ref{eq:color_blind_err_trit} для Тританопии:
        \begin{itemize}
            \item 
            \begin{equation}
                \label{eq:color_blind_err_prot}
                \begin{pmatrix}
                    R_{map(P)} \\
                    G_{map(P)} \\
                    B_{map(P)} \\
                \end{pmatrix} = 
                \begin{pmatrix}
                    0 & 0 & 0   \\
                    0.7 & 1 & 0 \\
                    0.7 & 0 & 1 \\
                \end{pmatrix} \cdot
                \begin{pmatrix}
                    D_{R(P)} \\
                    D_{G(P)} \\
                    D_{B(P)} \\
                \end{pmatrix}
            \end{equation}

            \item 
            \begin{equation}
                \label{eq:color_blind_err_deut}
                \begin{pmatrix}
                    R_{map(D)} \\
                    G_{map(D)} \\
                    B_{map(D)} \\
                \end{pmatrix} = 
                \begin{pmatrix}
                    1 & 0.7 & 0 \\
                    0 & 0 & 0   \\
                    0 & 0.7 & 1 \\
                \end{pmatrix} \cdot
                \begin{pmatrix}
                    D_{R(D)} \\
                    D_{G(D)} \\
                    D_{B(D)} \\
                \end{pmatrix}
            \end{equation}

            \item 
            \begin{equation}
                \label{eq:color_blind_err_trit}
                \begin{pmatrix}
                    R_{map(T)} \\
                    G_{map(T)} \\
                    B_{map(T)} \\
                \end{pmatrix} = 
                \begin{pmatrix}
                    1 & 0 & 0.7 \\
                    0 & 1 & 0.7 \\
                    0 & 0 & 1   \\
                \end{pmatrix} \cdot
                \begin{pmatrix}
                    D_{R(T)} \\
                    D_{G(T)} \\
                    D_{B(T)} \\
                \end{pmatrix}
            \end{equation}
        \end{itemize}

        \item Сложить исходное изображение со сдвинутыми цветами: \\
        $R_{F(i)} = R + R_{map(i)}$ \\
        $G_{F(i)} = G + G_{map(i)}$ \\
        $B_{F(i)} = B + B_{map(i)}$
    \end{enumerate}

    \subsection{CBFS алгоритм}

    Данный алгоритм использует цветовое пространство HSL. В шаге 2 алгоритма фигурирует параметр близости цвета и определяет насколько близок цвет пикселя в HSL к преобладающему цвету пикселя в RGB и равен абсолютной разнице между ними.

    CBFS алгоритм состоит из следующих шагов:
    \begin{enumerate}
        \item Конвертация изображения из цветового пространства RGB в HSL \footnote{Преобразование из RGB в HSL описано в главе \ref{sec:models_conerting}}
        \item Для каждого пикселя, \textbf{если} цвет пикселя достаточно близок к преобладающему цвету изображения (красный/зеленый) \textbf{тогда} \\
            Тон $\leftarrow$ Тон - 30\% \\
            Насыщенность $\leftarrow$ Насыщенность - 10\% \\
            Светлота $\leftarrow$ Светлота + 25\% \\
        \textbf{иначе} \\
            Насыщенность $\leftarrow$ Насыщенность + 10\% \\
            Светлота $\leftarrow$ Светлота - 10\% \\
        \item Конвертация из HSL в RGB. \footnote{Преобразование из HSL в RGB описано в главе \ref{sec:models_conerting}}
    \end{enumerate}

    \subsection{Алгоритм корректировки цвета LAB}

    Данный алгоритм модифицирует значение цвета в зависимости от типа цветовой слепоты следующим образом: алгоритм повышает контрастность необходимых цветов. В втором шаге необходимо отрегулировать значение параметра A. Положительное его значения обозначает, что он ближе к красному, а отрицательный ~---~ к зеленому. Значение цвета в LAB принадлежит [-100, 100]. 
    
    В данном алгоритме не хватает теоретических данных. Так, большинство значений были получены в ходе проб и ошибок в эксперименте с дальтоником. Наиболее подходящие преобразования для параметров L, B, A были найдены для дейтеранопии.

    Алгоритм корректировки цвета LAB состоит из следующих шагов: 
    \begin{enumerate}
        \item Конвертация изображения из цветовой модели RGB в LAB.
        \item Регулировка параметра A относительно его максимума: немного увеличить положительные значения и уменьшить отрицательные.
        \item Регулировка параметра B в зависимости от того, насколько зеленым или красным он является
        \item Изменение параметра L пикселей, который представляет из себя яркость пикселя относительно значений параметра A пикселей.
        \item Изображение конвертируется обратно в RGB и складывается с исходным, чтобы гарантировать, что значения цветов пикселей находится между 0 и 1.
    \end{enumerate}

    \subsection{Алгоритм цветового сдвига}

    В данном алгоритме параметр h --- коэффициент сдвига и зависит от типа дальтонизма. Для тританопии $h \in [0.1, 0.9]$. Наиболее подходящее значения для h при тританопии --- это 0.3.

    Данный алгоритм состоит из следующих шагов:
    \begin{enumerate}
        \item Конвертация изображения из RGB в HSV
        \item Сдвиг цвета для каждого пикселя $(x, y)$ с помощью уравнения \ref{eq:color_shift_1}
            \begin{equation}
            \label{eq:color_shift_1}
                H_{xy} = H_{xy} + h
            \end{equation}
        \item Проверка значения параметра H на принадлежность [0, 0.9]. \\
            \textbf{если} $(H_{xy} > 1)$ \textbf{то} \\
            $H_{xy} = 1 - H_{xy}$ \\
            \textbf{иначе} \\
            $H_{xy}$ = 0
        \item Конвертация изображения из HSV в RGB
    \end{enumerate}
 
    \section{Цветовая модель}
    Цветовая модель – термин, обозначающий абстрактную модель описания представления цветов в виде кортежей чисел, называемых цветовыми компонентами или цветовыми координатами. Вместе с методом интерпретации этих данных (например, определение условий воспроизведения или просмотра – то есть задание способа реализации), цвета цветовой модели определяет цветовое пространство.

    \subsection{Цветовая модель RGB}

    Цветовая модель RGB описывает излучаемые цвета. Она основана на трёх базовых цветах: красный (Red), зелёный (Green) и синий (Blue). Остальные цвета получаются сочетанием базовых. Цвета такого типа называются аддитивными. В компьютерах для представления каждой из координат традиционно используется один октет, значения которого обозначаются для удобства целыми числами от 0 до 255 включительно. Она применяется в приборах, излучающих свет, таких, например, как мониторы, прожекторы, фильтры.

    \subsection{Цветовая модель HSL}
    \label{sec:HSL_model}

    Цветовая модель HSL, HLS или HSI (от англ. Hue, Saturation, Lightness (Intensity)) – цветовая модель, в которой цветовыми координатами являются тон, насыщенность и светлота.

    \begin{itemize}
        \item Hue – цветовой тон (например, красный, зелёный или сине-голубой). Варьируется в пределах 0–360°, однако иногда приводится к диапазону 0–100 или 0–1.
        \item Saturation – насыщенность. Варьируется в пределах 0–100 или 0–1. Чем больше этот параметр, тем «чище» цвет, поэтому этот параметр иногда называют чистотой цвета. А чем ближе этот параметр к нулю, тем ближе цвет к нейтральному серому.
        \item Lightness (Intensity) – светлота (яркость). Постоянный оттенок (d, h) приводит к вертикальному поперечному сечению. Также задаётся в пределах 0–100 и 0–1.
    \end{itemize}

    \subsection{Цветовая модель HSLuv}
    Цветовая модель HSLuv является альтернативной версией модели HSL, которая позволяет с большей точностью (градацией) задать контраст цвета.

    \subsection{Цветовая модель CIELAB}

    Цветовая модель CIELAB – цветовая модель, в которой цветовыми ко- ординатами являются светлота от черного до белого, от зеленого до красного и от синего до желтого цветов.

    \begin{itemize}
        \item L – светлота от черного (0) до белого (100).
        \item A – светлота от зеленого (-) до красного (+).
        \item B – светлота от синего (-) до желтого (+).
    \end{itemize}

    Данная цветовая модель спроектирована так, что любое изменение числовых параметров компонент соответствующе влияет на визуальное восприятие.

    \subsection{Цветовая модель LCH}

    Цветовая модель LCH – "цилиндрическая" версия цветовой модели CIELAB, что означает, что вместо 6 цветовых параметров, доступных в CIELAB, используется только 4.

    \begin{itemize}
        \item L – светлота от черного (0) до белого (100).
        \item C – расстояние от серого (0 – 100).
        \item H – направление цвета (0 – 360) (0 – красный, 90 – желтый, 180 – зеленый, 270 – синий).
    \end{itemize}

    \section{Выбор цветовой модели для решения задачи}

    %//TODO

    \section{Конвертация цветов между цветовыми моделями}
    \label{sec:models_conerting}

    В формулах \ref{eq:rgbtohslh} -- \ref{eq:rgbtohsll} представлены шаги для получения компонент цвета цветовой модели HSL из RGB.
\begin{equation}
	{\label{eq:rgbtohslh}\displaystyle H={\begin{cases}{\mbox{undefined}}&{\mbox{if }}MAX=MIN\\60^{\circ }\times {\frac {G-B}{MAX-MIN}}+0^{\circ },&{\mbox{if }}MAX=R\\&{\mbox{and }}G\geq B\\60^{\circ }\times {\frac {G-B}{MAX-MIN}}+360^{\circ },&{\mbox{if }}MAX=R\\&{\mbox{and }}G<B\\60^{\circ }\times {\frac {B-R}{MAX-MIN}}+120^{\circ },&{\mbox{if }}MAX=G\\60^{\circ }\times {\frac {R-G}{MAX-MIN}}+240^{\circ },&{\mbox{if }}MAX=B\end{cases}},}
\end{equation}
\begin{equation}
	{\label{eq:rgbtohsls0}\displaystyle S={\begin{cases}0&{\mbox{if }}L=0{\mbox{ or }}MAX=MIN\\{\frac {MAX-MIN}{MAX+MIN}}={\frac {MAX-MIN}{2L}},&{\mbox{if }}0<L\leq {\frac {1}{2}}\\{\frac {MAX-MIN}{2-(MAX+MIN)}}={\frac {MAX-MIN}{2-2L}},&{\mbox{if }}{\frac {1}{2}}<L<1\\\end{cases}},}
\end{equation} или, в общем случае
\begin{equation}
	{\label{eq:rgbtohsls1}\displaystyle S={\frac {MAX-MIN}{1-|1-(MAX+MIN)|}},}
\end{equation}
\begin{equation}
	{\label{eq:rgbtohsll}\displaystyle L={\begin{matrix}{\frac {1}{2}}\end{matrix}}(MAX+MIN),}
\end{equation} где:
\begin{itemize}
	\item R, G, B -- значения цвета в цветовой модели RGB, значения в диапазоне [0; 1] (R - красный, G - зелёный, B - синий);
	\item MAX -- максимум из трёх значений (R, G, B);
	\item MIN -- минимум из трёх значений (R, G, B);
	\item H -- тон [0; 360];
	\item S -- насыщенность [0; 1];
	\item L -- светлота [0; 1].
\end{itemize}

    В формулах \ref{eq:hsltorgbr} -- \ref{eq:hsltorgbb} представлены шаги для получения компонент цвета цветовой модели RGB из HSL.
    \begin{equation}
        {\label{eq:hsltorgbr}\displaystyle Q={\begin{cases}L\times (1.0+S),&{\mbox{if }}L<0.5\\L+S-(L\times S),&{\mbox{if }}L\geq 0.5\end{cases}}}
    \end{equation}
    \begin{equation}
        {\displaystyle P=2.0\times L-Q}
    \end{equation}
    \begin{equation}
        {\displaystyle H_{k}={H \over 360}}
    \end{equation}
    \begin{equation}
        {\displaystyle T_{R}=H_{k}+{\frac {1}{3}}}
    \end{equation}
    \begin{equation}
        {\displaystyle T_{G}=H_{k}}
    \end{equation}
    \begin{equation}
        {\displaystyle T_{B}=H_{k}-{\frac {1}{3}}}
    \end{equation}
    \begin{equation}
        {\displaystyle {\mbox{if }}T_{c}<0\rightarrow T_{c}=T_{c}+1.0\quad {\mbox{for each}}\,c=R,G,B}
    \end{equation}
    \begin{equation}
        {\displaystyle {\mbox{if }}T_{c}>1\rightarrow T_{c}=T_{c}-1.0\quad {\mbox{for each}}\,c=R,G,B}
    \end{equation}
    Для каждого цвета $c = R,G,B$:
    \begin{equation}
        {\label{eq:hsltorgbb}\displaystyle \qquad \mathrm {color} _{c}={\begin{cases}P+\left((Q-P)\times 6.0\times T_{c}\right),&{\mbox{if }}T_{c}<{\frac {1}{6}}\\Q,&{\mbox{if }}{\frac {1}{6}}\leq T_{c}<{\frac {1}{2}}\\P+\left((Q-P)\times ({\frac {2}{3}}-T_{c})\times 6.0\right),&{\mbox{if }}{\frac {1}{2}}\leq T_{c}<{\frac {2}{3}}\\P,&{\mbox{otherwise }}\end{cases}}}
    \end{equation}

\end{document}
